<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RyanPhim - Hệ Thống Streaming Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root { --primary: #ff5b00; --bg: #111; }
        body { background-color: var(--bg); color: white; font-family: 'Roboto', sans-serif; }
        .section-title { border-left: 4px solid var(--primary); padding-left: 12px; font-weight: 800; text-transform: uppercase; }
        .movie-card:hover img { transform: scale(1.1); filter: brightness(0.7); }
    </style>
</head>
<body>

    <nav class="bg-black/90 sticky top-0 z-50 py-4 border-b border-white/5">
        <div class="container mx-auto px-4 flex justify-between items-center">
            <h1 onclick="location.reload()" class="text-3xl font-black text-[#ff5b00] cursor-pointer italic">RYANPHIM</h1>
            <div class="flex items-center bg-zinc-800 px-4 py-2 rounded-full w-1/3 border border-white/10">
                <input id="searchInput" type="text" placeholder="Tìm kiếm phim..." class="bg-transparent border-none outline-none text-xs w-full">
                <i class="fas fa-search text-gray-500" onclick="searchMovies()"></i>
            </div>
        </div>
    </nav>

    <div id="bigBanner" class="h-[500px] relative overflow-hidden bg-zinc-900">
        <div id="bannerContent" class="absolute inset-0 flex items-end p-12 bg-gradient-to-t from-[#111] via-transparent to-transparent"></div>
    </div>

    <main class="container mx-auto px-4 -mt-20 relative z-10">
        <div id="playerArea" class="hidden mb-12 bg-zinc-900 rounded-2xl overflow-hidden border border-white/10 shadow-2xl">
            <div class="aspect-video"><iframe id="mainIframe" class="w-full h-full" src="" frameborder="0" allowfullscreen></iframe></div>
            <div class="p-6">
                <h2 id="playTitle" class="text-2xl font-bold text-orange-500 mb-4"></h2>
                <div id="epList" class="flex flex-wrap gap-2"></div>
            </div>
        </div>

        <section class="mb-12">
            <h2 class="section-title text-xl mb-6">Phim Đề Cử</h2>
            <div id="gridHome" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-6"></div>
        </section>

        <section class="mb-12">
            <h2 class="section-title text-xl mb-6 text-blue-400">Phim Bộ Mới</h2>
            <div id="gridBo" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-6"></div>
        </section>

        <section class="mb-12">
            <h2 class="section-title text-xl mb-6 text-green-400">Phim Lẻ Mới</h2>
            <div id="gridLe" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-6"></div>
        </section>
    </main>

    <footer class="py-10 text-center border-t border-white/5 opacity-50 text-[10px] uppercase tracking-widest">
        © 2026 RYANPHIM - Thiết kế bởi Đặng Hoàng Thiện Nhân
    </footer>

    <script>
        const API = 'https://ophim1.com/v1/api';
        const IMG = 'https://phimimg.com/upload/poster/';

        async function init() {
            // Load trang chủ
            loadHome();
            // Load các dải phim theo Outline
            loadList('phim-bo', 'gridBo');
            loadList('phim-le', 'gridLe');
            
            document.getElementById('searchInput').onkeypress = (e) => { if(e.key === 'Enter') searchMovies(); };
        }

        async function loadHome() {
            const res = await fetch(`${API}/home`);
            const data = await res.json();
            const items = data.data.items;

            // Render Banner
            const top = items[0];
            document.getElementById('bigBanner').style.backgroundImage = `url(${IMG}${top.thumb_url})`;
            document.getElementById('bigBanner').style.backgroundSize = 'cover';
            document.getElementById('bannerContent').innerHTML = `
                <div>
                    <h2 class="text-5xl font-black uppercase mb-4">${top.name}</h2>
                    <button onclick="playPhim('${top.slug}')" class="bg-orange-600 px-8 py-3 rounded-sm font-bold hover:scale-105 transition">XEM NGAY</button>
                </div>
            `;

            renderGrid(items, 'gridHome');
        }

        async function loadList(slug, elementId) {
            const res = await fetch(`${API}/danh-sach/${slug}`);
            const data = await res.json();
            renderGrid(data.data.items.slice(0, 6), elementId);
        }

        function renderGrid(movies, elementId) {
            const grid = document.getElementById(elementId);
            grid.innerHTML = movies.map(m => `
                <div onclick="playPhim('${m.slug}')" class="movie-card group cursor-pointer transition-all">
                    <div class="relative aspect-[2/3] rounded-lg overflow-hidden bg-zinc-800 border border-white/5">
                        <img src="${IMG}${m.thumb_url}" class="w-full h-full object-cover transition duration-500" onerror="this.src='https://via.placeholder.com/300x450?text=RyanPhim'">
                        <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 bg-black/40 transition"><i class="fas fa-play text-4xl text-orange-500"></i></div>
                        <div class="absolute top-2 left-2 bg-blue-600 text-[9px] font-bold px-2 py-0.5 rounded-sm">${m.year || '2026'}</div>
                    </div>
                    <h3 class="mt-3 text-sm font-bold truncate group-hover:text-orange-500">${m.name}</h3>
                </div>
            `).join('');
        }

        async function playPhim(slug) {
            const res = await fetch(`${API}/phim/${slug}`);
            const data = await res.json();
            const phim = data.data.item;
            document.getElementById('playerArea').classList.remove('hidden');
            document.getElementById('playTitle').innerText = phim.name;
            document.getElementById('epList').innerHTML = phim.episodes[0].server_data.map(ep => `
                <button onclick="document.getElementById('mainIframe').src='${ep.link_embed}'" class="bg-zinc-800 hover:bg-orange-600 px-4 py-1.5 text-xs font-bold rounded-sm border border-white/10 uppercase">${ep.name}</button>
            `).join('');
            document.getElementById('mainIframe').src = phim.episodes[0].server_data[0].link_embed;
            window.scrollTo({ top: 400, behavior: 'smooth' });
        }

        init();
    </script>
</body>
</html>
